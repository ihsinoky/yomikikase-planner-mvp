
# Requirement Specification  
絵本読み聞かせ活動支援システム（LINE ミニアプリ＋管理 Web アプリ）

---

## 1. 目的（Purpose）

本システムは、幼稚園における「絵本読み聞かせ活動」を支援するための  
**参加アンケート収集・日程管理・絵本履歴管理** などを行う。

現状の Google フォーム＋LINE グループ＋Excel で散在している情報を整理し、

- 保護者の手間を減らす  
- 管理者の集計作業を軽減する  
- 絵本の履歴を園に知識として蓄積する  
- 個人情報は年度単位でクリアし、残し続けない  

というバランスを実現する。

---

## 2. スコープ（Scope）

### 2.1 対象とする活動

- 幼稚園の **月3回（年少・年中・年長）** の読み聞かせ会
- 参加者は各クラスの保護者
- 活動は **年度単位**（例：2025年度）で区切る

### 2.2 提供する主要機能（MVP）

- LINE ミニアプリによる保護者のアンケート回答
- 管理 Web アプリによるアンケート作成・結果確認
- 日程・参加者の「確定」登録機能
- 絵本の書誌データ管理（ISBNベース）と読書記録の保存（データモデルのみ必須、UIは後続）

### 2.3 非スコープ（MVPでやらない）

- 自動割当（公平性アルゴリズム）


---

## 3. 利用者（Stakeholders）

### 3.1 管理者（Administrator）

- 読み聞かせ運営担当者  
- Web 管理画面から操作  
- 操作内容：
  - アンケート作成
  - アンケート結果の閲覧・CSV エクスポート
  - 日程と参加者の確定
  - 絵本情報の登録（ISBN入力）

### 3.2 参加者（Parents / Guardians）

- 読み聞かせ会のボランティアとして参加  
- LINE ミニアプリから操作  
- 操作内容：
  - 初回プロフィール登録（名前・学年・クラス）
  - アンケート回答  
  - （将来）絵本登録補助

### 3.3 間接的な利用者（Kindergarten）

- 絵本履歴が園のノウハウとして残る  
- 運営負担が軽減される

---

## 4. 機能要求（Functional Requirements）

### 4.1 アンケート管理（Survey Management）

#### FR-001 管理者はアンケートを作成できる
- 項目：
  - 年度
  - タイトル
  - 説明文
  - 開催候補日（日時＋対象学年）

#### FR-002 アンケート用 URL を生成する
- LINE グループに貼るための URL を提供する。

#### FR-003 保護者はアンケートに回答できる（LIFF）
- 初回アクセス時にプロフィール登録：
  - 名前
  - 学年
  - クラス  
- 回答内容：
  - 各候補日ごとの参加可否

#### FR-004 回答結果を一覧表示できる
- 管理画面で：
  - 学年・クラスごとにフィルタ
  - 回答者名、学年、クラス、日程別可否を表示

#### FR-005 回答を CSV でエクスポートできる
- CSV 形式での出力
- 対象年度＋対象アンケート単位

---

### 4.2 日程確定（Confirm Event Management）

#### FR-006 管理者は確定日程を登録できる
- 項目：
  - 年度
  - 日付
  - 学年
  - クラス（任意）
  - 参加者（複数可）

#### FR-007 参加者選択は学年・クラスで絞り込みできる
- フィルタ：学年 → クラス → ユーザー一覧

#### FR-008 確定日程を一覧表示できる
- 年度別一覧
- 日付順
- 参加者名リストつき

---

### 4.3 絵本管理（Book Management）

#### FR-009 絵本マスタを登録できる（ISBNベース）
- ISBN を入力すると外部 API から書誌情報を取得
- DBに保存する情報：
  - ISBN
  - タイトル
  - 作者
  - 出版社
  - 表紙画像URL

#### FR-010 絵本の読み聞かせ記録を登録できる
- 日付
- 年度
- 学年
- クラス（任意）
- 絵本ID
- 備考（任意）

#### FR-011 絵本の履歴を検索できる（後続）
- 年度 × 学年一覧
- 絵本ごとの履歴

---

### 4.4 ユーザー管理（User Management）

#### FR-012 保護者は LINE userId で識別される
- LIFF から IDトークン or アクセストークンを取得し検証する

#### FR-013 プロフィールは年度ごとに分けて保持する
- 名前
- 学年
- クラス

#### FR-014 管理者はユーザーを一覧表示できる（簡易）

---

### 4.5 年度管理（School Year Management）

#### FR-015 年度を作成・切り替えできる
- 年度名（2025年度など）
- 開始日 / 終了日
- Active フラグ

#### FR-016 年度データの削除機能（後続）
- アンケート・回答・確定日程・UserYearProfile を削除
- 削除前にエクスポートを推奨

---

## 5. 非機能要求（Non-Functional Requirements）

### 5.1 パフォーマンス（NFR-P）

- 同時ユーザー数は小規模（数十名）
- 主要操作は 3 秒以内で応答すること

### 5.2 可用性（NFR-A）

- メンテ不要なクラウド環境を優先（Hono / Railway / Render / Vercel など）
- データベースのバックアップを日次で自動取得

### 5.3 セキュリティ（NFR-S）

- LIFF ログインの ID トークン検証を行う
- 管理者画面は ID/PW または OAuth2 で保護
- 保護者個人データは年度終了＋一定期間で削除可能に

### 5.4 拡張性（NFR-E）

- 将来的な自動割当ロジックを追加可能なデータモデルにする
- 絵本機能は UI 拡張で検索・レコメンドに育てられる設計にする

### 5.5 移行性（NFR-M）

- データは年度単位で切れるため、  
  1年度ごとにバックアップ・アーカイブ可能
- あなたが卒園した後でも管理権限を委譲できる設計にする

---

## 6. データ寿命（Data Lifecycle Requirements）

### DLR-001 個人データの長期保存を行わない
- Response / ConfirmedEvent / UserYearProfile は年度に紐づき、削除可能

### DLR-002 絵本データは永続的に保持する
- 個人識別情報と紐づかないため、長期保存してよい

### DLR-003 システム終了時に全データ削除できる
- 管理者向けの「全削除」機能を将来的に用意

---

## 7. 制約（Constraints）

- LINE ミニアプリは1つ（年度インスタンスは持てない）
- グループメンバー一覧の取得は不可（LIFF仕様）
- 公式アカウントがグループにメッセージを送れるが、  
  ミニアプリ自体が「グループにインストールされる」概念ではない
- 写真データは保持しない  
  → ISBN から取得した書誌情報の URL のみ保持する

---

## 8. 将来拡張（Future Enhancements）

- 自動割当アルゴリズム(Pythonでの実装あり)
- 絵本バーコード読み取り機能（カメラ利用）

---

## 9. 用語集（Glossary）

| 用語 | 説明 |
|------|------|
| LIFF | LINE Front-end Framework。LINE アプリ内部で動く Web アプリ。 |
| LINE userId | 各ユーザーに割り当てられる永続的な一意ID。 |
| Survey | 読み聞かせ参加可否アンケート。 |
| Confirmed Event | 確定した読み聞かせ開催日と参加者情報。 |
| Book | 絵本の書誌情報。ISBN を起点に統一管理する。 |
| BookReadingRecord | 「いつ・どの学年で・どの絵本を読んだか」の記録。 |
